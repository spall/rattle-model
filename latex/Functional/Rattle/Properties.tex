\begin{code}[hide]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.State}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Oracle}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{FileSystem}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Memory}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Cmd}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{extend}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{State}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{save}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Functional.Rattle.Properties}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Builtin.Equality}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.State.Helpers}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{St}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaPostulate{cmdWriteNames}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.State.Properties}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}lemma3 \AgdaSymbol{;} lemma4 \AgdaSymbol{;} run-≡\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Common.List.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∈-resp-≡}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{l11}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.Forward.Properties}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}cmdReadWrites \AgdaSymbol{;} IdempotentState \AgdaSymbol{;} IdempotentCmd \AgdaSymbol{;} cmdIdempotent\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.Forward.Exec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}get \AgdaSymbol{;} maybeAll \AgdaSymbol{;} run?\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.File}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{FileName}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{FileContent}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{if\AgdaUnderscore{}then\AgdaUnderscore{}else\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Relation.Binary.Disjoint.Propositional}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Disjoint}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}×\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{∃-syntax}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{,-injectiveʳ}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{,-injectiveˡ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Relation.Unary.All}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{lookup}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{List}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}++\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{foldr}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}∷\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{concatMap}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reverse}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∷ʳ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∷-injective}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{unfold-reverse}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Maybe}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong-app}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{decSetoid}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{inspect}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[\AgdaUnderscore{}]}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Membership.Propositional.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∈-++⁺ˡ}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{∈-++⁺ʳ}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{∈-++⁻}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{∈-concat⁻}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.String.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≟\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}==\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Membership.DecSetoid}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{decSetoid}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≟\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaUnderscore{}∈\AgdaUnderscore{} \AgdaSymbol{;} \AgdaUnderscore{}∈?\AgdaUnderscore{} \AgdaSymbol{;} \AgdaUnderscore{}∉\AgdaUnderscore{}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Nullary}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Nullary.Negation}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{contradiction}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Relation.Unary.Any}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{tail}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{here}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{there}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.Rattle.Exec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}rattle \AgdaSymbol{;} runWError \AgdaSymbol{;} run \AgdaSymbol{;} doRun \AgdaSymbol{;} rattle\AgdaUnderscore{}unchecked \AgdaSymbol{;} doRunWError \AgdaSymbol{;} checkHazard \AgdaSymbol{;} g₂\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.Build}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}Build \AgdaSymbol{;} UniqueEvidence \AgdaSymbol{;} PreCond \AgdaSymbol{;} DisjointBuild \AgdaSymbol{;} Cons\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{from-inj₂}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₁}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}⊎\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inj₂-injective}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.Script.Exec}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{Script}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.Script.Properties}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}dsj-≡\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.Script.Proofs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}reordered \AgdaSymbol{;} reordered≡\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.Script.Hazard}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}Hazard \AgdaSymbol{;} HazardFree \AgdaSymbol{;} FileInfo \AgdaSymbol{;} :: \AgdaSymbol{;} ¬SpeculativeHazard \AgdaSymbol{;} hazardContradiction \AgdaSymbol{;} ∃Hazard \AgdaSymbol{;} [] \AgdaSymbol{;} HFC \AgdaSymbol{;} hazardfree?\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}save \AgdaSymbol{to} rec\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Functional.Script.Hazard.Properties}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}hf-still\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{⊥}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{⊥-elim}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Relation.Unary.Unique.Propositional}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Unique}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Relation.Unary.AllPairs}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}∷\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Relation.Binary.Subset.Propositional}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊆\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List.Relation.Binary.Permutation.Propositional}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}↭\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Memory}\AgdaSpace{}%
\AgdaSymbol{->}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaInductiveConstructor{[]}%
\>[6]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
%
\>[1]\AgdaInductiveConstructor{Cons}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{mm}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Memory}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Cmd}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{->}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{sys}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{FileSystem}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{->}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈}}\AgdaSpace{}%
\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaSymbol{->}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{->}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaSymbol{->}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdReadWrites}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{getProperty}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{mm}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Memory}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Cmd}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{->}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaSymbol{->}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x∈}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{->}\AgdaSpace{}%
\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaPostulate{get}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdReadWrites}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈}}\AgdaSpace{}%
\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaSymbol{->}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{getProperty}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Cons}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≟}}\AgdaSpace{}%
\AgdaBound{x₁}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{x≡x₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{foldr}\AgdaSpace{}%
\AgdaFunction{extend}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdReadWrites}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaBound{x≡x₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x₃}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x₃}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaBound{x≡x₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subst}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x₃}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaBound{x₃}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{sys}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{x≡x₁}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{¬x≡x₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{getProperty}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{tail}\AgdaSpace{}%
\AgdaBound{¬x≡x₁}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{lemma1}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{FileSystem}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{v₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{v₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls₁}\<%
\\
\>[0]\AgdaFunction{lemma1}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{all₁}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{All.[]}\<%
\\
\>[0]\AgdaFunction{lemma1}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{px}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{All.∷}}\AgdaSpace{}%
\AgdaBound{all₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{∷-injective}\AgdaSpace{}%
\AgdaBound{≡₁}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{x₁≡x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subst}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{,-injectiveˡ}\AgdaSpace{}%
\AgdaBound{x₁≡x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{px}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{,-injectiveʳ}\AgdaSpace{}%
\AgdaBound{x₁≡x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{All.∷}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lemma1}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaBound{all₁}\AgdaSpace{}%
\AgdaBound{≡₂}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- Want to prove that system will be the same whether or not we run the command; -\}}\<%
\\
\>[0]\AgdaComment{\{- If a command's inputs and outputs are unchanged from when it was last run,
 then running it will have no effect. -\}}\<%
\\
\>[0]\AgdaFunction{noEffect}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{FileSystem}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{mm}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x∈}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{All}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{v₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{v₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{get}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\<%
\\
\>[0]\AgdaFunction{noEffect}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{mm}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSpace{}%
\AgdaBound{all₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{getProperty}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaBound{x∈}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{s₃}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{get≡}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{∀₂}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈?}}\AgdaSpace{}%
\AgdaPostulate{cmdWriteNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₁}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{f₁∉}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{lemma3}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f₁∉}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{f₁∈}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{lemma1}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{get}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdReadWrites}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₃}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{all₁}\AgdaSpace{}%
\AgdaBound{get≡}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{all₂}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s₃}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₂}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaBound{f₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaBound{all₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∈-++⁺ˡ}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{∀₂}\AgdaSpace{}%
\AgdaBound{f₂}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{)))))}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trans}%
\>[704I]\AgdaSymbol{(}\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaBound{all₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∈-++⁺ʳ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₃}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{f₁∈₁}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[704I]%
\>[17]\AgdaSymbol{(}\AgdaFunction{subst}%
\>[711I]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{foldr}\AgdaSpace{}%
\AgdaFunction{extend}\AgdaSpace{}%
\AgdaBound{s₃}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{foldr}\AgdaSpace{}%
\AgdaFunction{extend}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[711I]%
\>[24]\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSymbol{))}\<%
\\
%
\>[24]\AgdaSymbol{(}\AgdaPostulate{lemma4}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaBound{f₁∈}\AgdaSymbol{))}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[739I]\AgdaFunction{f₁∈₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈}}\AgdaSpace{}%
\AgdaPostulate{cmdWriteNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₃}\<%
\\
\>[.][@{}l@{}]\<[739I]%
\>[8]\AgdaFunction{f₁∈₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f₁∈}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{doRunSoundness}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{st₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ls₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{doRunWError}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{doRun}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{st₁}\<%
\\
\>[0]\AgdaFunction{doRunSoundness}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{checkHazard}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inj₂-injective}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{runSoundness}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{st₁}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{runWError}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{run}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{st₁}\<%
\\
\>[0]\AgdaFunction{runSoundness}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{st₁}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{run?}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{st}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inj₂-injective}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{doRunSoundness}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{≡₁}\<%
\end{code}

\begin{code}[hide]%
\>[0]\AgdaFunction{soundness-inner}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{st₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ls₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{rattle\AgdaUnderscore{}unchecked}}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{st₁}\<%
\\
\>[0]\AgdaFunction{soundness-inner}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{inj₂-injective}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{soundness-inner}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₂}%
\>[35]\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{runWError}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{inspect}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{runWError}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[}}\AgdaSpace{}%
\AgdaBound{≡₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{]}}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{runSoundness}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{st₂}\AgdaSpace{}%
\AgdaBound{ls₂}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{≡₂}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{≡st₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{rattle\AgdaUnderscore{}unchecked}}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaBound{≡st₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{soundness-inner}\AgdaSpace{}%
\AgdaBound{st₂}\AgdaSpace{}%
\AgdaBound{ls₂}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{OKBuild}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{FileInfo}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{Build}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{Build}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaFunction{OKBuild}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{DisjointBuild}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaPostulate{UniqueEvidence}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\<%
\end{code}

\newcommand{\soundness}{%
\begin{code}%
\>[0]\AgdaFunction{soundness}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{st}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ls}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{rattle\AgdaUnderscore{}unchecked}}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{st}\<%
\end{code}}
\begin{code}[hide]%
\>[0]\AgdaFunction{soundness}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{soundness-inner}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{≡₁}\<%
\end{code}

\begin{code}[hide]%
\>[0]\AgdaFunction{completeness-inner}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{OKBuild}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[13]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{st₁}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{completeness-inner}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{dsb}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ub₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ub₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{uls}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{dsj}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaFunction{completeness-inner}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{@(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaInductiveConstructor{Cons}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{x}}\AgdaSpace{}%
\AgdaBound{ds}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₁}}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{px}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{ub₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ub₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{uls}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{dsj₁}\AgdaSymbol{))}%
\>[109]\AgdaSymbol{(}\AgdaPostulate{::}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{s}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{ls}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{x}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₁}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₂}}\AgdaSpace{}%
\AgdaBound{¬hz}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈?}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{mm}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{maybeAll}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{get}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{checkHazard}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{⊥-elim}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{¬hz}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{completeness-inner}\AgdaSpace{}%
\AgdaFunction{st₂}\AgdaSpace{}%
\AgdaFunction{ls₂}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{dsb}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{mp₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ub₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ub₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{uls₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{dsj₂}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{hf}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1166I]\AgdaFunction{dsj₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Disjoint}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1166I]%
\>[8]\AgdaFunction{dsj₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{dsj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{there}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{tail}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{v≡x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaBound{px}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaBound{v≡x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{st₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{State}\<%
\\
%
\>[8]\AgdaFunction{st₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{save}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdWriteNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{mm}\<%
\\
%
\>[8]\AgdaFunction{ls₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{FileInfo}\<%
\\
%
\>[8]\AgdaFunction{ls₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{rec}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
%
\>[8]\AgdaFunction{uls₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{uls₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{g₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{dsj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{here}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{uls}\<%
\\
%
\>[8]\AgdaFunction{mp₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaFunction{st₂}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{mp₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{MemoryProperty.Cons}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{lemma3}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x₃}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{ds}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x₃}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{mp}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{completeness-inner}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{@(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaInductiveConstructor{Cons}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{x}}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₁}}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{px}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{ub₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ub₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{uls}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{dsj₁}\AgdaSymbol{))}%
\>[109]\AgdaSymbol{(}\AgdaPostulate{::}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{s}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{ls}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{x}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₁}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₂}}\AgdaSpace{}%
\AgdaBound{¬hz}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{all₁}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{noEffect}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSpace{}%
\AgdaBound{all₁}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{completeness-inner}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaPostulate{dsj-≡}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ub₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ub₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{uls}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{dsj₃}\AgdaSymbol{))}%
\>[110]\AgdaFunction{hf₂}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1346I]\AgdaFunction{dsj₃}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Disjoint}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1346I]%
\>[8]\AgdaFunction{dsj₃}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{dsj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{there}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{dsj₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Disjoint}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{dsj₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{dsj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{there}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{tail}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{v≡x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaBound{px}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaBound{v≡x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaFunction{uls₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{uls₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{g₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{dsj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{here}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{uls}\<%
\\
%
\>[8]\AgdaFunction{hf₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
%
\>[8]\AgdaFunction{hf₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{hf-still}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaPostulate{cmdWriteNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{ub₁}\AgdaSpace{}%
\AgdaFunction{uls₂}\AgdaSpace{}%
\AgdaFunction{dsj₂}\AgdaSpace{}%
\AgdaBound{hf}\<%
\\
\>[0]\<%
\\
\>[0]\AgdaFunction{completeness-inner}\AgdaSpace{}%
\AgdaBound{st}\AgdaSymbol{@(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaInductiveConstructor{Cons}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{x}}\AgdaSpace{}%
\AgdaBound{ds}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₁}}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{px}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{ub₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ub₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{uls}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{dsj₁}\AgdaSymbol{))}%
\>[109]\AgdaSymbol{(}\AgdaPostulate{::}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{s}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{ls}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{x}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₁}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₂}}\AgdaSpace{}%
\AgdaBound{¬hz}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{|}%
\>[142]\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{x∉}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{checkHazard}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{b₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{⊥-elim}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{¬hz}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{completeness-inner}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{save}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdWriteNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{rec}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{dsb}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{MemoryProperty.Cons}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{lemma3}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x₃}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{ds}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x₃}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ub₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ub₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{g₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{dsj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{here}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{uls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{dsj₂}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{hf}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1568I]\AgdaFunction{dsj₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Disjoint}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1568I]%
\>[8]\AgdaFunction{dsj₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{dsj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{there}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{tail}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{v≡x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaBound{px}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaBound{v≡x}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSymbol{))}\<%
\end{code}

\newcommand{\completeness}{%
\begin{code}%
\>[0]\AgdaFunction{completeness}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{PreCond}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{st}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)))}\<%
\end{code}}
\begin{code}[hide]%
\>[0]\AgdaFunction{completeness}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{dsb}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ubr}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ubc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{completeness-inner}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{dsb}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ubr}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ubc}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Data.List.Relation.Unary.AllPairs.[]}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{g₁}\AgdaSymbol{))))}\AgdaSpace{}%
\AgdaBound{hf}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1663I]\AgdaFunction{g₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Disjoint}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[.][@{}l@{}]\<[1663I]%
\>[8]\AgdaFunction{g₁}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\end{code}

\begin{code}[hide]%
\>[0]\AgdaFunction{script≡rattle-inner}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{DisjointBuild}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaBound{m}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{script}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{rattle\AgdaUnderscore{}unchecked}}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{script≡rattle-inner}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{∀₁}\<%
\\
\>[0]\AgdaFunction{script≡rattle-inner}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{Cons}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{x}}\AgdaSpace{}%
\AgdaBound{dsj}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₁}}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈?}}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{mm}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{x∉}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{script≡rattle-inner}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{save}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaPostulate{cmdWriteNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{run-≡}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{∀₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSpace{}%
\AgdaFunction{mp₁}\AgdaSpace{}%
\AgdaBound{f₁}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1764I]\AgdaFunction{mp₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{save}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaPostulate{cmdWriteNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1764I]%
\>[8]\AgdaFunction{mp₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{Cons}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₂}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{lemma3}\AgdaSpace{}%
\AgdaBound{f₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{dsj}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{mp}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{maybeAll}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{get}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{script≡rattle-inner}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{save}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaPostulate{cmdWriteNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{run-≡}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{∀₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSpace{}%
\AgdaFunction{mp₁}\AgdaSpace{}%
\AgdaBound{f₁}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1843I]\AgdaFunction{mp₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{save}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{cmdReadNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaPostulate{cmdWriteNames}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[1843I]%
\>[8]\AgdaFunction{mp₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{Cons}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₂}\AgdaSpace{}%
\AgdaBound{x₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{lemma3}\AgdaSpace{}%
\AgdaBound{f₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{oracle}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{dsj}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{x₂}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{mp}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{all₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{script≡rattle-inner}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaFunction{∀₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{dsj-≡}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaFunction{∀₃}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaBound{f₁}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[1904I]\AgdaFunction{∀₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaBound{f₁}\<%
\\
\>[.][@{}l@{}]\<[1904I]%
\>[8]\AgdaFunction{∀₂}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{noEffect}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{∀₁}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSpace{}%
\AgdaBound{all₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{∀₃}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{St.run}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{s₂}\AgdaSpace{}%
\AgdaBound{f₁}\<%
\\
%
\>[8]\AgdaFunction{∀₃}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{noEffect}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaBound{x∈}\AgdaSpace{}%
\AgdaBound{all₁}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- rattle produces a State and the System in that state is equivalent to the one produced by script}\<%
\\
\>[0]\AgdaFunction{≡toScript}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{FileSystem}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{Build}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{Build}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaFunction{≡toScript}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{script}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)))}\<%
\end{code}

\newcommand{\lemmasr}{%
\begin{code}%
\>[0]\AgdaOperator{\AgdaFunction{script≡rattle\AgdaUnderscore{}unchecked}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{DisjointBuild}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{script}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPostulate{rattle\AgdaUnderscore{}unchecked}}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\<%
\end{code}}
\begin{code}[hide]%
\>[0]\AgdaOperator{\AgdaFunction{script≡rattle\AgdaUnderscore{}unchecked}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{script≡rattle-inner}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\end{code}

\begin{code}[hide]%
\>[0]\AgdaComment{-- correctness is if you have any build then either you get the right answer (the one the script gave) or you get an error and there was a hazard.}\<%
\end{code}
\newcommand{\correct}{%
\begin{code}%
\>[0]\AgdaOperator{\AgdaFunction{correct\AgdaUnderscore{}rattle}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{PreCond}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{⊎}}\AgdaSpace{}%
\AgdaFunction{≡toScript}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{correct\AgdaUnderscore{}rattle}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{pc}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{inspect}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₁}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[}}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{]}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₁}\AgdaSpace{}%
\AgdaFunction{g₁}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[2081I]\AgdaFunction{g₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[.][@{}l@{}]\<[2081I]%
\>[8]\AgdaFunction{g₁}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{completeness}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{pc}\AgdaSpace{}%
\AgdaBound{hf}\<%
\\
%
\>[8]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{fst}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡₂}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{contradiction}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{≡₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaSymbol{()}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[}}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{]}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{∀≡}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[2133I]\AgdaFunction{∀≡}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{script}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{f₁}\<%
\\
\>[.][@{}l@{}]\<[2133I]%
\>[8]\AgdaFunction{∀≡}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}%
\>[2149I]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{script≡rattle\AgdaUnderscore{}unchecked}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{pc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2149I]%
\>[27]\AgdaSymbol{(}\AgdaFunction{cong-app}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{soundness}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{))}\<%
\end{code}}


\begin{code}[hide]%
\>[0]\AgdaComment{-- want to prove if execWError original build produces a hazard then execWError of the reordered build will produce a hazard too.}\<%
\\
\>[0]\AgdaComment{-- this would also mean if the reordered build doesnt produce a hazard, then the original build doesn't produce a hazard.}\<%
\\
\>[0]\AgdaComment{-- which means it produces a state.}\<%
\\
\>[0]\AgdaComment{-- then we use soundness to prove theyre equal to their non hazard versions ; then we use the reordering proof to show they're equivalent??}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{extra-lemma}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈}}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaOperator{\AgdaPostulate{∈}}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
\>[0]\AgdaFunction{extra-lemma}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{x∈b₁}\AgdaSpace{}%
\AgdaBound{y∈b₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{::}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{s}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{ls}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{x₁}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₂}}\AgdaSpace{}%
\AgdaDottedPattern{\AgdaSymbol{.}}\AgdaDottedPattern{\AgdaBound{b₁}}\AgdaSpace{}%
\AgdaBound{¬hz}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\{!!\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- for every pair of commands in b₂ (x , y) where x is before y; if x writes to something y reads; then (x , y) in b₁ too.}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{preservesHazards}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⊆}}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Unique}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
\>[0]\AgdaFunction{preservesHazards}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{⊆₁}\AgdaSpace{}%
\AgdaBound{ue}\AgdaSpace{}%
\AgdaBound{ue₁}\AgdaSpace{}%
\AgdaBound{¬hf}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{¬hf}\AgdaSpace{}%
\AgdaSymbol{\{!!\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[2248I]\AgdaComment{--g₃ : ∀ \{v\} → v ∈ cmdWriteNames x s → v ∈ files ls₂ → ⊥}\<%
\\
\>[0]\<%
\\
\>[.][@{}l@{}]\<[2248I]%
\>[8]\AgdaFunction{g₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaBound{ls₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{ls₂}\<%
\\
%
\>[8]\AgdaFunction{g₁}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaBound{ls₂}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\{!!\}}\<%
\\
%
\>[8]\AgdaFunction{g₁}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaBound{ls₂}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\{!!\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- if you have a pair of commands in b₂. (x , y) either or speculative hazard in b₂
 
-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- we know:
  x is in b₂ ; 
  x ∈ b₁ ; 
  x wrote to something a command in ls₂ read.   ; we should know ls₁ is a subset of ls₂
  if the command in ls₂ is in ls₁ 

  if there is a read/write or write/write hazard. => either there is a read/write write/write hazard or a speculative hazard.
 


-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-- :: s ls x b₁ [] (λ \AgdaUnderscore{} \AgdaUnderscore{} \AgdaUnderscore{} ∈[] \AgdaUnderscore{} \AgdaUnderscore{} → contradiction ∈[] (λ ())) (λ x₂ → contradiction (\{!!\} , \{!!\}) (¬sh \{!!\} \{!!\} \{!!\} \{!!\} \{!!\})) \{!!\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- preserving hazards:  Need to prove if the reordered build is hazardfree; then the original build is hazardfree.  

we know: there is a hazard there; read/write or write/write. we know x writes to something that
the build previously wrote.  somehow we need to produce a contradiction. 

we would have a speculative hazard if 

-\}}\<%
\\
\>[0]\<%
\end{code}

\begin{code}[hide]%
\>[0]\AgdaFunction{correct2}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{OKBuild}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{↭}}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{⊎}}\AgdaSpace{}%
\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{m₁}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{script}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaFunction{correct2}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{dsb}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ue}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{inspect}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₁}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[}}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{]}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\{!!\}}\<%
\\
\>[0]\AgdaComment{\{- proof plan:
  we know the reorderd build produced a hazard. this doesnt mean the original build has a hazard.  
  we could prove this case if we know the incorrect build doesn't corrupt the "inputs" of the build. 
  then we can run the correct build sequentially... and we would show that all the outputs of the build are still correct; so
  this says the systems are not exactly equivalent, but are equivalent for the outputs the build was MEANT to write.  
  for us to do both of these cases; we should change this lemma to say it only produces the same outputs for a certain set of files
-\}}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{st}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{[}}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{]}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\{!!\}}\AgdaSpace{}%
\AgdaComment{-- inj₂ ((st , \AgdaUnderscore{}) , refl , λ f₁ → sym (trans \{!!\} \{!!\}))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{-soundness : execwError b₁ = exec b₁ = script.exec b₁
                            exec b₂ = script.exec b₂ -\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- proof plan: 
  we know the reordered build doesn't produce a hazard.  which via some math should mean the original build doesnt produce a hazard. 
  1. get evidnce running the original build returns inj₂ 
  2. apply soundness to both.  
  3. use reordering proof. to show theyre the same for all files??  Of course we can only show that for two builds which are permutations where there are no extra commands.
     if we want to support the extra command thing the reodering proof needs to be expanded.
-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{\{- maybe in the paper we could just prove this for the case where speculation doesnt cause hazards. and explain future work proving the other case?
  so prove a subset of the correct2 lemma?
-\}}\<%
\end{code}

\newcommand{\correctS}{%
\begin{code}%
\>[0]\AgdaOperator{\AgdaFunction{correct\AgdaUnderscore{}speculation}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{PreCond}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{⊎}}\AgdaSpace{}%
\AgdaFunction{≡toScript}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\<%
\end{code}}
\begin{code}[hide]%
\>[0]\AgdaOperator{\AgdaFunction{correct\AgdaUnderscore{}speculation}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{pc}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{\{!!\}}\<%
\end{code}

\begin{code}[hide]%
\>[0]\AgdaFunction{semi-correct}%
\>[2424I]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{DisjointBuild}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{MemoryProperty}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{UniqueEvidence}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{↭}}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{⊎}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{⊎}}\AgdaSpace{}%
\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{m₁}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaFunction{∃[}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaFunction{]}\AgdaSymbol{(}\AgdaPostulate{rattle}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{script}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)))}\<%
\\
\>[.][@{}l@{}]\<[2424I]%
\>[13]\AgdaComment{-- ≡toScript (s , m) ls b₁ b₂ b₂}\<%
\\
\>[0]\AgdaFunction{semi-correct}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaBound{ue}\AgdaSpace{}%
\AgdaBound{b₂↭b₁}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{hazardfree?}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₁}\AgdaSpace{}%
\AgdaBound{hz}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{hazardfree?}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{ls}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₁}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{hf₁}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{completeness-inner}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{dsb}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ue}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{hf}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{reordered}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₂↭b₁}\AgdaSpace{}%
\AgdaBound{ue}\AgdaSpace{}%
\AgdaSymbol{\{!!\}}\AgdaSpace{}%
\AgdaBound{hf}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{script≡rattle-inner}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{f₂}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{dsb}\AgdaSpace{}%
\AgdaBound{mp}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong-app}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{soundness-inner}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{mm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaBound{b₁}\AgdaSpace{}%
\AgdaBound{b₂}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)))))}\<%
\\
\>[0]\AgdaComment{-- }\<%
\end{code}


\newcommand{\correctP}{%
\begin{code}%
\>[0]\AgdaOperator{\AgdaFunction{semi\AgdaUnderscore{}correct}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{PreCond}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{⊎}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{¬}}\AgdaSpace{}%
\AgdaPostulate{HazardFree}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{⊎}}\AgdaSpace{}%
\AgdaFunction{≡toScript}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{semi\AgdaUnderscore{}correct}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{pc}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{hazardfree?}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₁}\AgdaSpace{}%
\AgdaBound{hz}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{hf₁}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaPostulate{hazardfree?}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{no}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₁}\AgdaSpace{}%
\AgdaBound{hz}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{yes}\AgdaSpace{}%
\AgdaBound{hf₂}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{completeness}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{pc}\AgdaSpace{}%
\AgdaBound{hf₁}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{s₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{m₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{ls}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{,}}\AgdaSpace{}%
\AgdaFunction{∀≡}\AgdaSymbol{))}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{where}%
\>[2697I]\AgdaFunction{∀≡}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{s₁}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaPostulate{script}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{f₁}\<%
\\
\>[.][@{}l@{}]\<[2697I]%
\>[8]\AgdaFunction{∀≡}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{reordered≡}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{pc}\AgdaSpace{}%
\AgdaBound{hf₁}\AgdaSpace{}%
\AgdaBound{hf₂}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{script≡rattle\AgdaUnderscore{}unchecked}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSpace{}%
\AgdaBound{pc}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong-app}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{soundness}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaBound{br}\AgdaSpace{}%
\AgdaBound{bc}\AgdaSpace{}%
\AgdaBound{≡₁}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f₁}\AgdaSymbol{)))}\<%
\end{code}}

